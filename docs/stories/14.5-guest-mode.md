# Story 14.5: Guest Mode

## Status: Draft

## Story

**As a** player,
**I want** to play the game without creating an account,
**so that** I can try the game before committing to sign up.

## Acceptance Criteria

1. Game is fully playable without logging in
2. All progress saves to localStorage (current behavior)
3. No login prompts interrupt gameplay
4. Guest mode is the default state on first visit
5. UI clearly indicates "Playing as Guest" status
6. Option to create account is always accessible but not forced

## Tasks

- [ ] Document current localStorage-only behavior as "guest mode"
- [ ] Add visual indicator showing guest status in UI
- [ ] Ensure no auth checks block gameplay features
- [ ] Add "Sign In" button to main menu (non-intrusive)
- [ ] Verify all SaveManager functions work without auth

## Technical Notes

### Current Behavior (Already Implemented)

The game currently operates in what is effectively "guest mode":

```typescript
// SaveManager.ts - already works without auth
class SaveManagerClass {
  constructor() {
    this.saveData = this.loadFromStorage() || createDefaultSave();
  }

  private saveNow(): void {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(this.saveData));
  }
}
```

### Guest Mode Indicator

Add a small indicator to the main menu showing auth status:

```typescript
// In main menu render
function renderAuthStatus(): string {
  const isLoggedIn = authService?.isAuthenticated() ?? false;

  if (isLoggedIn) {
    const user = authService.getUser();
    return `<div class="auth-status logged-in">
      <span class="user-name">${user.displayName}</span>
      <span class="sync-status">Synced</span>
    </div>`;
  }

  return `<div class="auth-status guest">
    <span class="guest-label">Playing as Guest</span>
    <button class="sign-in-btn" onclick="window.showAuthScreen()">Sign In</button>
  </div>`;
}
```

### CSS for Guest Indicator

```css
.auth-status {
  position: absolute;
  top: 1rem;
  right: 1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-size: 0.875rem;
}

.auth-status.guest {
  color: var(--color-muted);
}

.auth-status.guest .sign-in-btn {
  padding: 0.25rem 0.75rem;
  font-size: 0.75rem;
  background: var(--color-accent);
  border: none;
  border-radius: 4px;
  cursor: pointer;
}

.auth-status.logged-in {
  color: var(--color-success);
}

.sync-status {
  font-size: 0.75rem;
  opacity: 0.7;
}
```

### No Auth Barriers

Ensure these features work for guests:
- [x] Start new run
- [x] Play combat
- [x] Earn Soul Echoes
- [x] Purchase upgrades
- [x] Unlock achievements
- [x] Save/load game
- [x] All character classes (free ones)

### What Guests Can't Do

- Sync progress to cloud
- Access progress from another device
- Recover progress if localStorage is cleared

## Definition of Done

- [ ] Game works identically for guests as it does today
- [ ] Guest indicator shows in UI
- [ ] Sign-in option is visible but non-intrusive
- [ ] No regressions in existing save/load functionality

## Dependencies

None - this documents existing behavior and adds UI indicator

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-05 | 1.0 | Story created | Mary (Analyst) |
