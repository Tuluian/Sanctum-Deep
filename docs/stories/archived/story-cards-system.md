# Story Cards System — Narrative Moments Between Rooms

## Status: Done

## Overview

**Story Cards** are brief narrative moments that appear after certain room nodes, giving players glimpses into the world, the Warden's thoughts, and their character's inner journey. They build atmosphere without interrupting gameplay flow.

---

## Design Philosophy

### Goals
- Create **emotional texture** between combat encounters
- Reveal lore **organically**, not through info-dumps
- Make each playthrough feel **narratively unique**
- Reinforce **class identity** through character-specific thoughts
- Build **anticipation** for bosses and major story beats

### Constraints
- **Short**: 2-4 sentences maximum
- **Skippable**: Players can dismiss instantly
- **Non-blocking**: No choices or branching (save that for shrines)
- **Evocative**: Suggest more than they explain

---

## Trigger System

Story Cards appear based on:

| Trigger Type | Description | Example |
|-------------|-------------|---------|
| **Progress** | After X rooms cleared | "The halls grow colder." |
| **First Blood** | After first combat in act | Class-specific first kill reflection |
| **Pre-Boss** | Before boss room | Warden warning/lore |
| **Post-Boss** | After boss defeated | Victory reflection, transition |
| **Health Threshold** | When HP drops below 30% | Desperation thoughts |
| **Elite Defeated** | After killing elite enemy | Lore about what you just killed |
| **Random** | 15% chance after any room | Ambient atmosphere |

---

## Card Categories

### 1. Warden Whispers (Lyra's Voice)
The Warden speaks to you throughout. Her voice grows fainter as you descend.

### 2. Character Thoughts
Internal monologue specific to each class.

### 3. Environmental Observations
What the character notices about their surroundings.

### 4. Lore Fragments
Brief hints about the Sanctum's history.

### 5. Foreshadowing
Hints about what's coming next.

---

# Act 1: The Entrance Halls

## Warden Whispers — Act 1

### First Encounter (After Room 1)
> **Lyra:** *"You made it past the threshold. That's more than most. The Sanctum is watching you now. So am I."*

### Mid-Act (After Room 5-7)
> **Lyra:** *"Lord Vexal was a hero once. Remember that when you face him. We all were, once."*

### Pre-Bonelord Warning
> **Lyra:** *"He's close. I can feel him stirring. Three hundred years of pride, waiting on a throne of bones."*
>
> *"End his suffering, champion. He was a hero once."*

### Post-Bonelord
> **Lyra:** *"It's done. Lord Vexal of the Crimson Banner... rest now."*
>
> *"The path to Act 2 opens. The Drowned King awaits. He was my friend, you know. Before."*

---

## Character Thoughts — Act 1

### Cleric (Elara)

**After First Combat:**
> *Brother Aldous, guide my hands. Or don't. You haven't been guiding anything lately, have you?*

**After Taking Heavy Damage:**
> *I heal others. Who heals me? The silence where my prayers used to go.*

**Before Bonelord:**
> *A warrior who sought immortality. Did he pray, too? Did something answer?*

**After Bonelord:**
> *He forgot his purpose. I'm looking for mine. Are we really so different?*

---

### Knight (Varren)

**After First Combat:**
> *First blood. Ser Aldric always said: "The first kill is the hardest." He was wrong. They're all hard.*

**After Taking Heavy Damage:**
> *The Order trained us to endure. They didn't train us to question. Maybe they should have.*

**Before Bonelord:**
> *Lord Vexal trained with the Order. These techniques I'm using—he invented some of them.*

**After Bonelord:**
> *He remembered the stance. At the end, he recognized me as a Knight. Was that comfort or cruelty?*

---

### Diabolist (Mordecai)

**After First Combat:**
> *Xan'thrax is laughing somewhere. He always knew I'd be good at violence.*

**After Taking Heavy Damage:**
> *The curse is faster down here. The Sanctum accelerates everything. Even dying.*

**Before Bonelord:**
> *A king who bargained for eternity. Sound familiar? At least he got what he paid for.*

**After Bonelord:**
> *Three hundred years of immortality, and he forgot why he wanted it. Note to self: have an exit strategy.*

---

### Oathsworn (Callista)

**After First Combat:**
> *The Order says these souls are prisoners. I'm starting to think they're refugees.*

**After Taking Heavy Damage:**
> *"Pain is truth made manifest." That's what Sister Mara wrote. Easy to say when you're not bleeding.*

**Before Bonelord:**
> *He ruled here. Another kind of Warden. The Order says they're all the same—monsters guarding a cage.*

**After Bonelord:**
> *He thanked me. At the end. Monsters don't thank their killers. What if the Order is wrong about everything?*

---

### Fey-Touched (Wren)

**After First Combat:**
> *Oberon is watching. I can feel him giggling. This is all a game to him.*

**After Taking Heavy Damage:**
> *"Good luck, little mortal." His voice, in my head, laughing at my blood.*

**Before Bonelord:**
> *A skeleton king? Sure. Why not. Nothing in my life makes sense anymore. Why should death?*

**After Bonelord:**
> *He was someone's lord. Someone's hero. And Oberon threw me at him like a coin into a well.*
>
> *At least the coin sank. Spite is fuel.*

---

### Celestial (Seraphina)

**After First Combat:**
> *Auriel is excited. It likes the violence. That's... concerning.*

**After Taking Heavy Damage:**
> *"We're hurt, little host. We should be more careful. I don't want a new vessel."*
>
> *Always "we." Never "you."*

**Before Bonelord:**
> *He sought immortality. Auriel offers something similar. Eternal existence as someone else's battery.*

**After Bonelord:**
> *The light burned him. MY light. Not Auriel's—mine. I'm starting to tell the difference.*

---

### Summoner (Caelum)

**After First Combat:**
> *My wisps are holding together. This place—it makes them more solid. More real.*

**After Taking Heavy Damage:**
> *They throw themselves in front of me. I didn't ask them to. I can't stop them.*
>
> *Is this love or programming? Does it matter?*

**Before Bonelord:**
> *He commands dead soldiers. Memories given form. My children are different. They're new. Fresh. Right?*

**After Bonelord:**
> *His soldiers faded when he died. They only existed because he remembered them.*
>
> *My wisps—when I forget them, what happens to them?*

---

### Bargainer (Vesper)

**After First Combat:**
> *Malachar is screaming at the barriers. I can feel it. He's so close, and so helpless.*
>
> *Good.*

**After Taking Heavy Damage:**
> *Lily. I saved Lily. That's worth any price. Even this one.*

**Before Bonelord:**
> *A king who made a bad deal. Glory for eternity. Should have read the fine print, your majesty.*

**After Bonelord:**
> *He was a client, in a way. The Sanctum collected when he couldn't pay. Harsh terms.*
>
> *I can do better.*

---

## Environmental Observations — Act 1

**Room 2-3:**
> *The stones here remember being carved. Names etched into every surface, too worn to read.*

**Room 4-5:**
> *Tapestries line the walls. The threads show battles, victories, crowns. All faded. All forgotten.*

**Room 6-7:**
> *The torches aren't lit. The light comes from somewhere else. From everywhere else.*

**Room 8-9:**
> *Bones in the corners. Not piled—arranged. Someone mourned them once.*

**Pre-Boss:**
> *A throne room. The throne is made of bones. And someone is sitting on it.*

---

## Lore Fragments — Act 1

**Random (15% after any room):**
> *A child's toy, preserved in crystal. The Sanctum remembers strange things.*

> *Carved into the wall: "MIRA WAS HERE. MIRA IS GONE." Below it, fresher: "SO WAS I."*

> *A suit of armor, empty, still standing at attention. Still guarding a door that no longer exists.*

> *The Warden's symbol appears everywhere. A circle containing nothing. A door that never opens.*

> *Flowers grow here. Impossible. Nothing should grow here. But they do.*

---

# Act 2: The Flooded Depths

## Warden Whispers — Act 2

### First Encounter
> **Lyra:** *"Welcome to Thalassar. Or what remains of it. A kingdom drowned in one man's love."*

### Mid-Act
> **Lyra:** *"Aldric and I were friends, once. Before the drowning. Before the forgetting."*
>
> *"I still remember his wedding. Elara was beautiful. He couldn't stop smiling."*

### Pre-Drowned King Warning
> **Lyra:** *"He's waiting for you. He's been waiting for four hundred years."*
>
> *"Don't hate him for what he's become. Hate what took him from himself."*

### Post-Drowned King
> **Lyra:** *"Aldric... goodbye, old friend. Say hello to Elara for me."*
>
> *"The Core awaits. The Hollow God stirs. Remember what Aldric gave. Remember what love costs."*

---

## Character Thoughts — Act 2

### Cleric (Elara)

**After First Combat:**
> *A kingdom that prayed. A king who sacrificed. And still they drowned.*
>
> *What's the point of faith if this is where it leads?*

**Mid-Act:**
> *Aldric's prayers weren't answered either. But he kept praying. He kept hoping.*
>
> *Maybe that's the point. Not the answer—the asking.*

**Before Drowned King:**
> *He saved three thousand children with his soul. What would I give for Brother Aldous?*
>
> *Everything. The answer is everything.*

**After Drowned King:**
> *He saw Elara's face at the end. After four hundred years of forgetting, he saw her again.*
>
> *That's not faith. That's something stronger.*

---

### Knight (Varren)

**After First Combat:**
> *These soldiers are memories. Echoes of loyalty, still standing guard.*
>
> *Would the Order's knights become this? Would I?*

**Mid-Act:**
> *The Order's records mention Aldric. He trained with us for a year. "Too gentle," they said.*
>
> *"Too gentle" saved a kingdom.*

**Before Drowned King:**
> *Ser Aldric told me about King Aldric. Same name, different men.*
>
> *"He was what a king should be," my mentor said. "What I should have been."*

**After Drowned King:**
> *He asked if his sacrifice was worth it. I said yes. I hope I wasn't lying.*

---

### Diabolist (Mordecai)

**After First Combat:**
> *Aldric made a deal too. Soul for kingdom. Clean terms. No hidden clauses.*
>
> *Xan'thrax could learn something from that.*

**Mid-Act:**
> *The water here remembers love. The stone remembers grief. Everything here is... honest.*
>
> *I forgot what honest deals feel like.*

**Before Drowned King:**
> *He traded his soul willingly. I traded mine because I was dying.*
>
> *Which of us is the bigger fool?*

**After Drowned King:**
> *He forgot his wife's face but remembered her love. That's what he held onto. The feeling, not the details.*
>
> *I hold onto spite. Is that enough?*

---

### Oathsworn (Callista)

**After First Combat:**
> *The Order says the Wardens exploit people. Aldric exploited no one. He gave freely.*
>
> *Sister Mara's writings didn't mention this kind of sacrifice.*

**Mid-Act:**
> *"The Sanctum corrupts all it touches." But what if some things can't be corrupted?*
>
> *What if love is stronger than the void?*

**Before Drowned King:**
> *He chose to become a monster to save children. The Order would call that corruption.*
>
> *I call it heroism.*

**After Drowned King:**
> *The Burning Truth says all bargains with the Sanctum are evil. They're wrong.*
>
> *Some bargains are love.*

---

### Fey-Touched (Wren)

**After First Combat:**
> *Oberon is quiet. For once. Even he doesn't find this funny.*

**Mid-Act:**
> *A king who chose to suffer. Oberon would never understand.*
>
> *Neither would I, a year ago. Now... now I'm starting to.*

**Before Drowned King:**
> *He loved someone so much he became a monster. I didn't choose anything.*
>
> *What does that make me?*

**After Drowned King:**
> *He remembered her face. At the end, after everything, he remembered.*
>
> *I want to remember something like that. I want something worth forgetting.*

---

### Celestial (Seraphina)

**After First Combat:**
> *Auriel is terrified. The water here dissolves parasites.*
>
> *For the first time, I feel powerful and* alone*.*

**Mid-Act:**
> *"Love is an anchor," the Warden says. Auriel's hold is fear, not love.*
>
> *What would love feel like?*

**Before Drowned King:**
> *He sacrificed his identity for others. I've had mine stolen.*
>
> *Can you choose to give what someone already took?*

**After Drowned King:**
> *Elara. The name he couldn't forget. The face that survived four hundred years of drowning.*
>
> *Auriel will never understand that. But I might.*

---

### Summoner (Caelum)

**After First Combat:**
> *His soldiers are memories. My wisps are creations. The difference feels thinner here.*

**Mid-Act:**
> *Aldric's love created soldiers from nothing but remembrance. I do the same thing.*
>
> *Are my children real, or just very detailed memories?*

**Before Drowned King:**
> *He held on to love for four hundred years. I've held on to my wisps for two.*
>
> *Is that enough time to make them real?*

**After Drowned King:**
> *His soldiers faded with him. They were extensions of his will.*
>
> *My wisps might be extensions of mine. But they also love me back. That's different. It has to be.*

---

### Bargainer (Vesper)

**After First Combat:**
> *Aldric made a bargain. Soul for children. No fine print. No escalation clause.*
>
> *The cleanest contract I've ever seen.*

**Mid-Act:**
> *Malachar's screaming is quieter here. The water muffles even hellish rage.*
>
> *Finally. Some peace.*

**Before Drowned King:**
> *He paid in full. Up front. No installments, no interest, no hidden fees.*
>
> *That's not how devils do business. That's how heroes do.*

**After Drowned King:**
> *Three thousand children. That was his price. Three thousand lives for one soul.*
>
> *I broke my contract for one child. Was that enough?*
>
> *Yes. It was enough.*

---

## Environmental Observations — Act 2

**Room 1-2:**
> *The water isn't cold. It's warm, like tears.*

**Room 3-4:**
> *Underwater tapestries show a wedding. The king's face is scratched out. The queen's face is pristine.*

**Room 5-6:**
> *Nurseries, preserved. Toys for children who grew up and forgot the king who saved them.*

**Room 7-8:**
> *Love letters, water-damaged but readable. "Come back to me." "I can't." "Then I'll come to you."*

**Pre-Boss:**
> *A throne of coral and grief. A crown that still drips. A king who remembers everything except why.*

---

## Lore Fragments — Act 2

**Random (15% after any room):**
> *A portrait of Queen Elara. Someone has added new paint to keep her colors bright. For four hundred years.*

> *"THALASSAR STANDS." Carved into the wall. It doesn't stand anymore. Hasn't for centuries.*

> *Children's drawings, preserved in crystal. "MY HERO" with a crown and a smile.*

> *The seal of Thalassar: a wave encircling a heart. The kingdom is gone. The symbol remains.*

> *"Elara forgive me" written a thousand times. The same handwriting. The same plea.*

---

# Act 3: The Sanctum Core

## Warden Whispers — Act 3

### First Encounter
> **Lyra:** *"You're close now. I can barely reach you. The void interferes with... everything."*
>
> *"Remember who you are. Remember why you came. Don't let it take that."*

### Mid-Act (Voice Fragmenting)
> **Lyra:** *"I've been... Warden... 347 years. Soon it will be... someone else..."*
>
> *"...your choice... always... your choice..."*

### Pre-Hollow God Warning
> **Lyra:** *"It's here. The nothing that hungers. The shadow where Kael used to be."*
>
> *"I can't help you anymore. I'm too faded. But I believe in you."*
>
> *"Win or lose... thank you. For trying. For being brave enough to reach the end."*

### Post-Hollow God
> **Lyra:** (clear, for the first time)
>
> *"You did it. You held on. You remembered."*
>
> *"Now... the choice."*

---

## Character Thoughts — Act 3

### All Classes — Universal Moments

**First Room (Reality Bending):**
> *Colors are wrong here. Sounds have edges. My name feels slippery.*

**Mid-Act (Identity Erosion):**
> *What was I looking for? Why did I come here? I had a reason. I HAD A REASON.*

**Pre-Hollow God:**
> *I am [CHARACTER NAME]. I am [CLASS]. I came here because [MOTIVATION].*
>
> *I am. I am. I AM.*

---

### Cleric (Elara) — Act 3 Specific

**After First Combat:**
> *Brother Aldous is here. I can feel his crystal. My god, preserved, silent, waiting.*

**Mid-Act:**
> *He served for four hundred years. He answered my prayers until he couldn't anymore.*
>
> *He didn't abandon me. He faded. He gave everything.*

**Before Hollow God:**
> *I came looking for my god. I found him. He was a man who chose to serve.*
>
> *Maybe that's what gods are. Just people who don't give up.*

---

### Knight (Varren) — Act 3 Specific

**After First Combat:**
> *Ser Aldric's crystal is here. I can see his face. He looks... ashamed.*

**Mid-Act:**
> *He hesitated. For one moment, he wanted the peace. That's why he's here.*
>
> *But he came back. He kept fighting. Hesitation isn't failure.*

**Before Hollow God:**
> *I might hesitate too. The void offers rest. Rest sounds so good.*
>
> *But I'm not done standing. Not yet.*

---

### Diabolist (Mordecai) — Act 3 Specific

**After First Combat:**
> *Xan'thrax's voice is louder here. Right at the threshold, screaming.*
>
> *But he can't enter. The barriers work. Even against him.*

**Mid-Act:**
> *The contract says I retrieve a fragment. It doesn't say I have to leave.*
>
> *Loopholes work both ways, devil.*

**Before Hollow God:**
> *If I become the Warden, the curse... doesn't matter. Wardens don't die naturally.*
>
> *Immortality for imprisonment. Better terms than Xan'thrax ever offered.*

---

### Oathsworn (Callista) — Act 3 Specific

**After First Combat:**
> *Sister Mara's crystal is here. The 22nd Warden. The Order's founder.*
>
> *She tried to destroy this place. She failed. But she wrote the truth.*

**Mid-Act:**
> *The Order isn't wrong about everything. This place IS a prison. But prisoners can be guards too.*
>
> *Guards can choose what they're guarding.*

**Before Hollow God:**
> *I swore to destroy the Sanctum. I can't destroy it. But maybe... maybe I can change it.*
>
> *New vows. Better vows.*

---

### Fey-Touched (Wren) — Act 3 Specific

**After First Combat:**
> *Oberon is silent. Actually silent. The barriers here block even him.*
>
> *This is the first time in months I've been alone in my own head.*

**Mid-Act:**
> *The Warden said Oberon owes her a favor. From a riddle game, 258 years ago.*
>
> *If I become the Warden, he can't touch me. And she can collect.*

**Before Hollow God:**
> *I didn't choose to be here. But I can choose what happens next.*
>
> *For the first time in my life, I get to write the ending.*

---

### Celestial (Seraphina) — Act 3 Specific

**After First Combat:**
> *The God of Dawn's crystal is here. Massive. Beautiful. Auriel's source.*
>
> *Auriel is weeping. It remembers being whole.*

**Mid-Act:**
> *I can purge Auriel here. Send it back to its source. Or... or I can keep it.*
>
> *Not as a parasite. As a partner. If that's even possible.*

**Before Hollow God:**
> *Whoever I face the void as—Sara, Seraphina, or something new—that's my choice.*
>
> *For the first time, the light is mine.*

---

### Summoner (Caelum) — Act 3 Specific

**After First Combat:**
> *The Congregation is here. Scattered. Broken. Looking for its source.*
>
> *My colleagues are in there. Fragments of them. Still screaming.*

**Mid-Act:**
> *But so are my children. Lumina. Bastion. Whisper. Preserved by love. Waiting.*
>
> *I can bring them back. All of them. If I survive.*

**Before Hollow God:**
> *My family is waiting. Not the Circle—the wisps. The ones who died for me.*
>
> *Everything I've done, I've done for them.*

---

### Bargainer (Vesper) — Act 3 Specific

**After First Combat:**
> *The Hollow God operates on contract logic. Take identities, receive... nothing.*
>
> *Worst deal I've ever seen. No return value at all.*

**Mid-Act:**
> *What if I could renegotiate? Not fight the void—DEAL with it?*
>
> *Everyone wants something. Even cosmic horrors. Right?*

**Before Hollow God:**
> *I've closed deals with devils, criminals, and kings. One more negotiation.*
>
> *This time, the client is the nothing at the heart of everything.*

---

## Environmental Observations — Act 3

**Room 1-2:**
> *The walls are crystallized Wardens. Dozens of them. Centuries of guardians, preserved in their final moments.*

**Room 3-4:**
> *Reality isn't solid here. Corners don't quite meet. Shadows fall in the wrong direction.*

**Room 5-6:**
> *Your reflection in the crystal is wrong. It blinks when you don't. It smiles when you're not smiling.*

**Room 7-8:**
> *Names whisper in the darkness. Thousands of names. Everyone the void has consumed.*

**Pre-Boss:**
> *The center of everything. A space where light should be but isn't. An absence with hunger.*

---

## Lore Fragments — Act 3

**Random (15% after any room):**
> *A name floats past: "KAEL." The oldest name here. The first consumed.*

> *The void isn't dark. It's colorless. The absence of even black.*

> *"I REMEMBER" carved into crystal. Then, below it: "I FORGET." Same handwriting.*

> *A complete skeleton, arranged in meditation pose. Peaceful. Chosen.*

> *Your name, whispered by something that has no voice. It knows you already.*

---

# Implementation Notes

## Data Structure

```typescript
interface StoryCard {
  id: string;
  trigger: StoryCardTrigger;
  act: 1 | 2 | 3 | 'all';
  classId?: CharacterClassId; // Undefined = universal
  speaker?: 'warden' | 'character' | 'environment' | 'lore';
  text: string;
  priority: number; // Higher = more likely to show
  showOnce?: boolean; // Only show once per run
}

interface StoryCardTrigger {
  type: 'progress' | 'first_blood' | 'pre_boss' | 'post_boss' |
        'health_threshold' | 'elite_defeated' | 'random';
  value?: number; // Room number, HP threshold, etc.
}
```

## Display Rules

1. **Maximum one Story Card per room** — Don't interrupt flow
2. **Priority ordering** — Warden > Character > Environment > Lore
3. **Class-specific beats generic** — Show character thought over generic observation
4. **Boss cards are mandatory** — Pre/post boss cards always show
5. **Random cards can be skipped** — If player moves quickly, skip random cards

## UI Recommendations

- **Visual style**: Parchment texture, faded edges, handwritten-looking font
- **Animation**: Fade in, hold 2 seconds, fade on click or timeout
- **Position**: Bottom third of screen, doesn't cover combat area
- **Audio**: Soft paper-rustle sound on appear
- **Skip**: Any click dismisses immediately

---

## Tasks

- [x] Create StoryCard type in src/types/narrativeEvents.ts
- [x] Implement NarrativeEventService for story card logic
- [x] Create StoryCardOverlay UI component
- [x] Implement Act 1 story cards
  - [x] Warden whispers (4 cards)
  - [x] Environmental observations (4 cards)
  - [x] Lore fragments (5 random cards)
  - [x] Cleric character thoughts (4 cards)
  - [x] Knight character thoughts (4 cards)
  - [x] Diabolist character thoughts (4 cards)
  - [x] Oathsworn character thoughts (4 cards)
  - [x] Fey-Touched character thoughts (4 cards)
  - [x] Celestial character thoughts (4 cards)
  - [x] Summoner character thoughts (4 cards)
  - [x] Bargainer character thoughts (4 cards)
- [x] Implement Act 2 story cards
  - [x] Warden whispers (4 cards)
  - [x] Environmental observations (4 cards)
  - [x] Lore fragments (5 random cards)
- [x] Implement Act 3 story cards
  - [x] Warden whispers (4 cards)
  - [x] Environmental observations (4 cards)
  - [x] Universal character thoughts (2 cards)
  - [x] Lore fragments (5 random cards)
- [x] Story card trigger system (progress, boss, health, random)
- [x] Story card styling in main.css

---

## Dev Agent Record

### Agent Model Used
Claude (Dev)

### Completion Notes List
- Full story card system implemented with 70+ unique cards
- All 10 character classes have Act 1 character thoughts
- Warden whispers, environmental observations, and lore fragments for all 3 acts
- Trigger system supports progress, pre/post boss, health threshold, elite defeated, and random triggers
- Priority system ensures class-specific beats override generic observations

### File List
- `src/types/narrativeEvents.ts` - StoryCard type and StoryCardTrigger interface
- `src/services/NarrativeEventService.ts` - Story card selection and display logic
- `src/services/NarrativeEventService.test.ts` - Unit tests
- `src/ui/screens/StoryCardOverlay.ts` - Story card UI overlay
- `src/data/storyCards.ts` - All story card definitions (70+ cards)
- `src/styles/main.css` - Story card styling

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-12-04 | 1.0 | Initial Story Cards system design | World Builder Agent |
| 2025-12-06 | 1.1 | Added missing class character cards (Oathsworn, Fey-Touched, Celestial, Summoner, Bargainer), marked Done | James (Dev) |
